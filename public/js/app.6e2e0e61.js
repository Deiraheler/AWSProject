(function(){var e={5852:function(e,t,o){"use strict";var n=o(45130),r=o(56768);const a={id:"app"},s={class:"container"},l=(0,r.Lk)("h1",null,"Keyboard Warriors Blog",-1),i={class:"container"},u=(0,r.Lk)("footer",null,[(0,r.Lk)("p",null,"Â© 2024 Keyboard Warriors.")],-1);function c(e,t,o,n,c,p){const d=(0,r.g2)("router-link"),g=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",a,[(0,r.Lk)("header",s,[l,(0,r.Lk)("nav",null,[(0,r.bF)(d,{to:"/"},{default:(0,r.k6)((()=>[(0,r.eW)("Blog")])),_:1}),n.isUserLoggedIn?((0,r.uX)(),(0,r.Wv)(d,{key:0,to:"/post"},{default:(0,r.k6)((()=>[(0,r.eW)("Post")])),_:1})):(0,r.Q3)("",!0),n.isUserLoggedIn?((0,r.uX)(),(0,r.CE)("a",{key:2,class:"button-logout",onClick:t[0]||(t[0]=(...e)=>n.logout&&n.logout(...e))},"Sign Out")):((0,r.uX)(),(0,r.Wv)(d,{key:1,to:"/signin"},{default:(0,r.k6)((()=>[(0,r.eW)("Sign In")])),_:1}))])]),(0,r.Lk)("main",i,[(0,r.bF)(g)]),u])}var p=o(60782),d={name:"App",setup(){const e=(0,p.Pj)(),t=(0,r.EW)((()=>e.state.userLogin)),o=()=>{e.dispatch("removeUserLogin")};return{isUserLoggedIn:t,logout:o}}},g=o(71241);const m=(0,g.A)(d,[["render",c]]);var v=m,f=o(81387),k=o(24232);const h=e=>((0,r.Qi)("data-v-70e26f8a"),e=e(),(0,r.jt)(),e),L=h((()=>(0,r.Lk)("h1",null,"All Posts",-1))),y={class:"parent"},w=["href"],b={class:"content"},U=["src"];function E(e,t,o,n,a,s){return(0,r.uX)(),(0,r.CE)("div",null,[L,(0,r.Lk)("div",y,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(n.state.posts,(e=>((0,r.uX)(),(0,r.CE)("a",{href:"/post/"+e.postId,key:e.postId},[(0,r.Lk)("h2",null,(0,k.v_)(e.title),1),(0,r.Lk)("p",b,(0,k.v_)(e.trimmedContent),1),e.imageURL?((0,r.uX)(),(0,r.CE)("img",{key:0,src:e.imageURL,alt:"Post Image"},null,8,U)):(0,r.Q3)("",!0),(0,r.Lk)("p",null,"Author: "+(0,k.v_)(e.authorId),1),(0,r.Lk)("p",null,"Date: "+(0,k.v_)(n.formatDate(e.createdAt)),1)],8,w)))),128))])])}var _=o(90144),C=o(98355),R={setup(){const e=(0,_.Kh)({posts:[]}),t=e=>{const t=new Date(e);return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},o=e=>{const t=50;return e.length>t?e.substring(0,t)+"...":e},n=async()=>{try{const t=await C.A.get("https://3xwoe7u9h2.execute-api.eu-west-1.amazonaws.com/all");e.posts=t.data.map((e=>({...e,trimmedContent:o(e.content)})))}catch(t){console.error("Error fetching posts:",t)}};return(0,r.sV)(n),{state:e,formatDate:t}}};const K=(0,g.A)(R,[["render",E],["__scopeId","data-v-70e26f8a"]]);var A=K;const S={class:"block-container"},I=(0,r.Lk)("h1",null,"Login",-1),P=(0,r.Lk)("label",{for:"email"},"Email",-1),O=(0,r.Lk)("label",{for:"password"},"Password",-1),j=(0,r.Lk)("button",{type:"submit"},"Login",-1),x={style:{color:"red"}};var X={__name:"LoginComponent",setup(e){const t=(0,_.KR)(""),o=(0,_.KR)(""),a=(0,_.KR)(""),s=(0,p.Pj)(),l=async()=>{try{const e=await C.A.post("https://ld9tepy989.execute-api.eu-west-1.amazonaws.com/login",{email:t.value,password:o.value});a.value="",s.dispatch("setUserLogin",e.data.token),console.log("Login successful:",e.data)}catch(e){e.response?(console.error("Error response:",e.response.data),a.value=e.response.data.message||"Error logging in"):(console.error("Error message:",e.message),a.value="Network error, please try again")}};return(e,s)=>((0,r.uX)(),(0,r.CE)("div",S,[I,(0,r.Lk)("form",{onSubmit:(0,n.D$)(l,["prevent"])},[(0,r.Lk)("div",null,[P,(0,r.bo)((0,r.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":s[0]||(s[0]=e=>t.value=e),required:""},null,512),[[n.Jo,t.value]])]),(0,r.Lk)("div",null,[O,(0,r.bo)((0,r.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":s[1]||(s[1]=e=>o.value=e),required:""},null,512),[[n.Jo,o.value]])]),j,(0,r.Lk)("p",x,(0,k.v_)(a.value),1)],32)]))}};const V=X;var D=V;const F={class:"block-container"},q=(0,r.Lk)("h1",null,"Register",-1),J={class:"form-group"},z=(0,r.Lk)("label",{for:"username"},"Username",-1),T={class:"form-group"},W=(0,r.Lk)("label",{for:"email"},"Email",-1),Q={class:"form-group"},$=(0,r.Lk)("label",{for:"password"},"Password",-1),B=(0,r.Lk)("button",{type:"submit"},"Register",-1);var M={__name:"RegisterComponent",setup(e){const t=(0,_.KR)(""),o=(0,_.KR)(""),a=(0,_.KR)(""),s=(0,p.Pj)(),l=async()=>{if(a.value.length<6)return void alert("Password must be at least 6 characters long!");const e="https://ld9tepy989.execute-api.eu-west-1.amazonaws.com/register",n={username:t.value,email:o.value,password:a.value};try{const t=await C.A.post(e,n),o=t.data.token;if(!o)throw new Error("Token not received");s.dispatch("setUserLogin",o),alert("Registration successful!")}catch(r){console.error(r.response?r.response.data:r.message),alert("Registration failed!")}};return(e,s)=>((0,r.uX)(),(0,r.CE)("div",F,[q,(0,r.Lk)("form",{onSubmit:(0,n.D$)(l,["prevent"])},[(0,r.Lk)("div",J,[z,(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>t.value=e),type:"text",id:"username",required:""},null,512),[[n.Jo,t.value]])]),(0,r.Lk)("div",T,[W,(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>o.value=e),type:"email",id:"email",required:""},null,512),[[n.Jo,o.value]])]),(0,r.Lk)("div",Q,[$,(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>a.value=e),type:"password",id:"password",required:"",minlength:"6"},null,512),[[n.Jo,a.value]])]),B],32)]))}};const N=M;var H=N;const Y={class:"sign-in-containers"};var Z={__name:"SigninView",setup(e){return(e,t)=>((0,r.uX)(),(0,r.CE)("div",Y,[(0,r.bF)(D),(0,r.bF)(H)]))}};const G=Z;var ee=G;const te=e=>((0,r.Qi)("data-v-1fde81cc"),e=e(),(0,r.jt)(),e),oe=te((()=>(0,r.Lk)("h1",null,"Post",-1))),ne={key:0},re={key:1,class:"block-container"},ae=["src"],se={class:"credentials"},le={key:2},ie=te((()=>(0,r.Lk)("p",null,"Loading...",-1))),ue=[ie];function ce(e,t,o,n,a,s){return(0,r.uX)(),(0,r.CE)("div",null,[oe,n.errorOut?((0,r.uX)(),(0,r.CE)("div",ne,[(0,r.Lk)("p",null,"Error loading post: "+(0,k.v_)(n.errorOut.message),1)])):n.post?((0,r.uX)(),(0,r.CE)("div",re,[(0,r.Lk)("h2",null,(0,k.v_)(n.post.title),1),n.post.imageURL?((0,r.uX)(),(0,r.CE)("img",{key:0,src:n.post.imageURL,alt:"Post Image"},null,8,ae)):(0,r.Q3)("",!0),(0,r.Lk)("p",null,(0,k.v_)(n.post.content),1),(0,r.Lk)("div",se,[(0,r.Lk)("p",null,"Author: "+(0,k.v_)(n.post.authorId),1),(0,r.Lk)("p",null,(0,k.v_)(n.formatDate(n.post.createdAt)),1)])])):((0,r.uX)(),(0,r.CE)("div",le,ue))])}var pe={setup(){const e=(0,_.KR)(null),t=(0,_.KR)(null),o=(0,f.lq)(),n=async()=>{const n=o.params.id;try{const t=await C.A.get(`https://3xwoe7u9h2.execute-api.eu-west-1.amazonaws.com/${n}`);e.value=t.data}catch(r){console.error("Error fetching post:",r),t.value=r}},a=e=>{const t=new Date(e);return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})};return(0,r.sV)(n),{post:e,errorOut:t,formatDate:a}}};const de=(0,g.A)(pe,[["render",ce],["__scopeId","data-v-1fde81cc"]]);var ge=de,me=(o(44114),o(35926)),ve=o.n(me);const fe=e=>((0,r.Qi)("data-v-0b703ac2"),e=e(),(0,r.jt)(),e),ke={class:"post-form"},he=fe((()=>(0,r.Lk)("h1",null,"Create post",-1))),Le=fe((()=>(0,r.Lk)("label",{for:"image-upload"},"Image (optional):",-1))),ye=fe((()=>(0,r.Lk)("button",{type:"submit"},"Create post",-1)));var we={__name:"PostCreateView",setup(e){const t=(0,_.KR)(""),o=(0,_.KR)(""),a=(0,_.KR)(null),s=(0,_.KR)(null),l=(0,_.KR)(null),i=(0,_.KR)(null);async function u(){try{const e=new(ve().Credentials)({accessKeyId:"AKIA2UC3AYLKVJJRFZOK",secretAccessKey:"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"});ve().config.update({region:"eu-west-1",credentials:e});const t=document.getElementById("file-upload").files;let o=[];for(let n=0;n<t.length;n++){let e=t[n],r=e.name,a=new(ve().S3.ManagedUpload)({params:{Bucket:"blog-images-keyboard-warriors",Key:r,Body:e}});o.push(a.promise())}await Promise.all(o).then((function(e){console.log("Successfully uploaded files:",e),i.value=e[0].Location,console.log("File URL:",i.value)})).catch((function(e){console.error("Error uploading files:",e)}))}catch(e){throw console.error("Error uploading to S3:",e),new Error("Failed to upload image.")}}const c=async()=>{if(localStorage.getItem("token")){if(l.value)try{await u()}catch(e){return console.error("Error during image upload:",e),void alert("Failed to upload image. Please try again.")}try{const e={title:t.value,content:o.value,imageUrl:i.value};console.log(e),await C.A.post("https://3xwoe7u9h2.execute-api.eu-west-1.amazonaws.com/",e,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),t.value="",o.value="",l.value=null}catch(e){console.error("Failed to create post:",e)}}else alert("User must be logged in to create posts.")},p=e=>{a.value=e.target.files[0].name,s.value=e.target.files[0].type,l.value=e.target.files[0]};return(e,a)=>((0,r.uX)(),(0,r.CE)("div",ke,[he,(0,r.Lk)("form",{onSubmit:(0,n.D$)(c,["prevent"])},[Le,(0,r.Lk)("input",{type:"file",id:"file-upload",ref_key:"file",ref:l,style:{display:"none"},accept:"image/*",onChange:p},null,544),(0,r.Lk)("div",{class:"imageUpload",onClick:a[0]||(a[0]=t=>e.$refs.file.click())}),(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>t.value=e),placeholder:"Title",required:""},null,512),[[n.Jo,t.value]]),(0,r.bo)((0,r.Lk)("textarea",{"onUpdate:modelValue":a[2]||(a[2]=e=>o.value=e),placeholder:"Content",required:""},null,512),[[n.Jo,o.value]]),ye],32)]))}};const be=(0,g.A)(we,[["__scopeId","data-v-0b703ac2"]]);var Ue=be;const Ee=(0,p.y$)({state(){return{userLogin:localStorage.getItem("token")||!1}},mutations:{setUserLogin(e,t){e.userLogin=t,t?localStorage.setItem("token",t):localStorage.removeItem("token"),Ke.push("/")}},actions:{setUserLogin({commit:e},t){e("setUserLogin",t)},removeUserLogin({commit:e}){e("setUserLogin",!1)},async getPresignedUrl(e,t,o){const n="https://y0i5knkev8.execute-api.eu-west-1.amazonaws.com/getURL";try{const e=await C.A.post(n,{fileName:t,fileType:o});return e.data}catch(r){throw console.error("Failed to get pre-signed URL:",r),r}}},getters:{getUserLogin(e){return e.userLogin}}});var _e=Ee;const Ce=[{path:"/",name:"HomeView",component:A},{path:"/signin",name:"SigninView",component:ee},{path:"/post/:id",name:"PostView",component:ge},{path:"/post",name:"PostCreateView",component:Ue,meta:{requiresAuth:!0}}],Re=(0,f.aE)({history:(0,f.LA)("/"),routes:Ce});Re.beforeEach(((e,t,o)=>{e.matched.some((e=>e.meta.requiresAuth))?_e.getters.getUserLogin?o():o({path:"/signin"}):o()}));var Ke=Re;const Ae=(0,n.Ef)(v);Ae.use(Ke),Ae.use(_e),Ae.mount("#app")},11976:function(){}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.loaded=!0,a.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,a){if(!n){var s=1/0;for(c=0;c<e.length;c++){n=e[c][0],r=e[c][1],a=e[c][2];for(var l=!0,i=0;i<n.length;i++)(!1&a||s>=a)&&Object.keys(o.O).every((function(e){return o.O[e](n[i])}))?n.splice(i--,1):(l=!1,a<s&&(s=a));if(l){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,r,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,s=n[0],l=n[1],i=n[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(i)var c=i(o)}for(t&&t(n);u<s.length;u++)a=s[u],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(c)},n=self["webpackChunkfront"]=self["webpackChunkfront"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(5852)}));n=o.O(n)})();
//# sourceMappingURL=app.6e2e0e61.js.map